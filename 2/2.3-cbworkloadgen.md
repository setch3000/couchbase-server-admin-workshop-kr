# 2.3 애플리케이션 클라이언트에서 cbworkloadgen을 실행

다음으로, 새 App Client에서 cbworkloadgen을 실행해 보겠습니다.

현재 App Client의 PuTTY/터미널 셸에 로그인되어 있어야 합니다.

<figure><img src="../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>



## 1. '.bash\_profile' 파일에 노드 변수를 설정합니다( $NODE1/home/ec2-user/.bash\_profile 에서 복사할 수도 있습니다).

.bash\_profile 파일을 편집합니다:

```bash
[ec2-user@ Couchbase01 ~]$ cd ~
[ec2-user@ Couchbase01 ~]$ vi .bash_profile
```



9–26줄을 파일에 추가합니다.\
현재 파일에는 다음과 같이 1–8줄이 표시되어 있어야 합니다:

```bash
      1.bash_profile
      2
      3 # Get the aliases and functions
      4 if [ -f ~/.bashrc ]; then
      5         . ~/.bashrc
      6 fi
      7
      8 # User specific environment and startup programs
```



9–12줄은 PATH와 MANPATH 변수용입니다.

```bash
      9 PATH=$PATH:/opt/couchbase/bin
     10 export PATH
     11 MANPATH=$MANPATH:/opt/couchbase/share/man
     12 export MANPATH
```



노드 이름과 USERNAME & PASSWORD 변수를(약 13번째 줄) 추가합니다. 파일 끝에 다음 줄들을 추가하고, 노드 이름은 이 과정 초반에 제공된 AMAZON 전역 DNS 이름으로 교체하세요. 마지막으로 couchbase REST\_USERNAME과 REST\_PASSWORD 선언을 추가하세요. 모든 변수를 `export`하는 것도 잊지 마세요.

```bash
  13  AppServer=ec2-48-54-199-69.us-west-1.compute.amazonaws.com
  14  export AppServer

  15  NODE1=ec2-113-156-188-191.us-west-1.compute.amazonaws.com
  16  NODE2=ec2-115-156-209-124.us-west-1.compute.amazonaws.com
  17  NODE3=ec2-113-157-200-184.us-west-1.compute.amazonaws.com
  18  NODE4=ec2-118-144-149-199.us-west-1.compute.amazonaws.com
  19  NODE5=ec2-154-183-155-127.us-west-1.compute.amazonaws.com
  20  NODE6=ec2-154-183-183-230.us-west-1.compute.amazonaws.com
  21  NODE7=ec2-154-219-170-126.us-west-1.compute.amazonaws.com
  22  NODE8=ec2-154-219-174-110.us-west-1.compute.amazonaws.com

  23  export NODE1 NODE2 NODE3 NODE4 NODE5 NODE6 NODE7 NODE8

  24  CB_REST_USERNAME=Administrator
  25  CB_REST_PASSWORD=couchbase
  26  export CB_REST_USERNAME CB_REST_PASSWORD
```



vi 또는 nano 세션에서 저장하고 종료한 뒤,

.bash\_profile 파일을 `source`합니다.\
또한 .bashrc 파일을 source하여 변경 사항이 현재 bash 세션에 적용되도록 합니다:



```bash
[ec2-user@ Couchbase01 ~]$ source ~/.bash_profile
```





## 2. cbworkloadgen을 사용하여 PATH를 테스트합니다.

```bash
[ec2-user@ AppServer ]$ cbworkloadgen -n $NODE1:8091
```

출력:

```
[####################] 100.0% (10527/estimated 10526 msgs)
bucket: default, msgs transferred...
: total | last | per sec
byte : 105270 | 105270 | 290846.9

done
```

{% hint style="info" %}
초당 처리량은 vCPU와 메모리에 따라 달라집니다.
{% endhint %}



## `3. cbworkloadgen` 실행&#x20;

크기 10바이트의 항목 100,000개를 작성하되, 작업의 50%를 쓰기로 설정해 보세요:

```
[ec2-user@AppServer ]$ cbworkloadgen -n $NODE1:8091 -i 100000 -r .5
-s 10
```

이 명령은 실행 완료까지 약 10초가 걸리며, 결과는 다음과 비슷할 것입니다:

```
[####################] 100.0% (199999/estimated 200000 msgs)
bucket: default, msgs transferred...
       :                total |       last |    per sec
 byte  :              1999990 |    1999990 |   321261.4
done
```

이전 실습에서 기억하시겠지만, Couchbase 서버와 동일한 VM에서 cbworkloadgen을 실행했을 때 초당 약 25,000 ops가 측정되었습니다(결과는 Amazon 데이터센터의 동적 클라우드 환경에 따라 달라질 수 있습니다).\
제 경우에는 클라이언트 애플리케이션이 초당 약 321,261.4 바이트의 I/O를 보고하고 있습니다.

